<div class="sticky side-nav-container side-nav-expanded" [style.height]="height">
  <nav class="content" [style.height]="height" fxLayout="column">
    <div class="header" fxLayout="row" fxLayoutAlign="center center" fxLayoutGap="10px">
      <div class="logo" fxLayout="row" fxLayoutAlign="center center">
        <img src="favicon.ico" />
      </div>
    </div>

    <div class="side-nav-section">
      <nav fxLayout="column" fxLayoutGap="10px">
        <div
          *ngFor="let link of links"
          class="links-section"
          [ngClass]="{ 'links-section-active': openedNavs$ | async | arrayIncludes: link.icon }"
        >
          <div
            *ngIf="link.children"
            class="link-main"
            fxLayout="row"
            fxLayoutAlign="space-between center"
            (click)="toggleNav(link.icon)"
          >
            <ng-template [ngTemplateOutlet]="linkTemplate" [ngTemplateOutletContext]="{ link: link }"></ng-template>
          </div>

          <ng-template
            [ngTemplateOutlet]="aLinkTemplate"
            [ngTemplateOutletContext]="{ link: link, isSublink: false }"
          ></ng-template>

          <div *ngIf="openedNavs$ | async | arrayIncludes: link.icon" class="link-sublink">
            <div *ngFor="let subLink of link.children">
              <ng-template
                [ngTemplateOutlet]="aLinkTemplate"
                [ngTemplateOutletContext]="{ link: subLink, isSublink: true }"
              ></ng-template>
            </div>
          </div>
        </div>
      </nav>
    </div>

    <div class="footer" fxLayout="column" fxLayoutGap="10px">
      <div class="bmb-container" fxLayout="row" fxLayoutAlign="center center">
        <a
          href="https://www.buymeacoffee.com/fantasyblstats"
          target="_blank"
          class="bmb"
          fxLayout="row"
          fxLayoutAlign="center center"
          fxLayoutGap="10px"
        >
          <angular-emojis [name]="'beer'" [size]="25"></angular-emojis>
          <div fxLayout="column">
            <span>Like it?</span>
            <span>Buy me a beer</span>
          </div>
        </a>
      </div>

      <div class="socials" fxLayout="row" fxLayoutAlign="center center" fxLayoutGap="20px">
        <a class="social-media" href="https://www.facebook.com/Fantasybl-stats-108481224674753" target="blank">
          <fa-icon class="social-media-icon" [icon]="['fab', 'facebook-f']"></fa-icon>
        </a>
        <a class="social-media" href="https://twitter.com/FantasyblS" target="blank">
          <fa-icon class="social-media-icon" [icon]="['fab', 'twitter']"></fa-icon>
        </a>
      </div>
    </div>
  </nav>
</div>

<ng-template #linkTemplate let-link="link">
  <div fxLayoutAlign="center center">
    <span class="link-line" [ngClass]="{ 'link-line-active': openedNavs$ | async | arrayIncludes: link.icon }"
      >&nbsp;</span
    >
    <mat-icon class="link-icon" [ngClass]="{ 'link-icon-active': openedNavs$ | async | arrayIncludes: link.icon }">{{
      link.icon
    }}</mat-icon>
    <span class="link-text">{{ link.text }}</span>
  </div>
  <mat-icon
    *ngIf="link.children"
    class="link-expand"
    [ngClass]="{ 'link-expand-active': openedNavs$ | async | arrayIncludes: link.icon }"
    >chevron_right</mat-icon
  >
</ng-template>

<ng-template #aLinkTemplate let-link="link" let-isSublink="isSublink">
  <a
    *ngIf="!link.children"
    class="link-main"
    [ngClass]="{ 'link-main-sublink': isSublink }"
    fxLayout="row"
    fxLayoutAlign="space-between center"
    [href]="link.path"
  >
    <ng-template [ngTemplateOutlet]="linkTemplate" [ngTemplateOutletContext]="{ link: link }"></ng-template>
  </a>
</ng-template>
